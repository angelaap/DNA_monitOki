---
title: "Rain, wind analysis_RSproject"
author: "Angela Ares"
date: '`r format(Sys.Date(), "%b %d, %Y")`'
output:
  html_document:
    toc: true
    theme: cosmo
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
```


Loading packages
```{r packages, include=FALSE}
library(ggplot2)
library(tidyverse)
library(jcolors)
library(ggfortify)
library(lubridate)
```

## Getting rain and wind data and cleaning

Kenneth Dudley downloaded the data from [JMA](https://www.jma.go.jp/jma/indexe.html). This is 10 min data.
Here is a map with the weather stations in Okinawa also made by Kenneth.

![](map.png)
Big rain events seems
```{r getting data and cleaning rain}

rawind<- read.csv("~/Documents/Projects OIST/RS/DNA year monitoring project/Raw_rain_wind/RainWind_10min_2020_Nov_to_2021_Oct.csv")
sumrain<- rawind %>% 
  mutate(dates = ymd_hms(eventDate),
         day = date(dates)) %>% 
  group_by(day, site_id_en) %>% 
  summarise(acc_Rain = sum(precipitation_mm))

#some stations dont have rain data so it is better to remove them

new_sumrain<- sumrain[!grepl("Naha|Nago", sumrain$site_id_en),]


#lets make a lineplot with accumulated rain per day and site 

rainplot<- ggplot(new_sumrain, aes(x=day)) + 
  geom_line(aes(y=acc_Rain), size=0.5, color="black")+
  scale_y_continuous(name = "Accumulated rain (mm)")+ 
  facet_grid(site_id_en ~ .)+ 
  theme_bw()

rainplot
```


Lets see the wind intensity
```{r EDA wind}

meanwind<- rawind %>% 
  mutate(dates = ymd_hms(eventDate),
         day = date(dates)) %>% 
  group_by(day, site_id_en) %>% 
  summarise(mean_wind = mean(windAvgSpeed_ms))
  
meanmaxwind<- rawind %>% 
  mutate(dates = ymd_hms(eventDate),
         day = date(dates)) %>% 
  group_by(day, site_id_en) %>% 
  summarise(mean_maxwind = mean(windMaxSpeed_ms))
  
windy <- left_join(meanwind, meanmaxwind, by=c('day', 'site_id_en'))

#some stations dont have rain data so it is better to remove them

windytot<- windy[!grepl("Goya|Yomitan|Kuniga", sumrain$site_id_en),]


#lets make a lineplot with accumulated rain per day and site 

windplot<- ggplot(windytot, aes(x=day)) + 
  geom_line(aes(y=mean_wind), size=0.5, color="black")+
  geom_line(aes(y=mean_maxwind), size=0.5, color="red")+
  scale_y_continuous(name = "Wind intensity (m/s)")+ 
  facet_grid(site_id_en ~ .)+ 
  theme_bw()

windplot
```